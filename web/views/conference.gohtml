<link rel="stylesheet" href="/assets/src/styles/conference.css">

<script type="module" src="/assets/src/scripts/conference.js"></script>

<main class="conference-container">
    <section id="createConference" class="conference-create d-none">
        <div class="conference-card">
            <div class="conference-header">
                <div class="logo-container">
                    <svg class="logo" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                    </svg>
                </div>
                <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é</h2>
                <p class="conference-subtitle">–ù–∞—á–Ω–∏—Ç–µ –≤—Å—Ç—Ä–µ—á—É —Å –≤–∞—à–∏–º–∏ –∫–æ–ª–ª–µ–≥–∞–º–∏</p>
            </div>

            <form id="createConferenceForm" class="conference-form">
                <div class="form-group">
                    <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏</label>
                    <div class="input-group">
                        <span class="input-icon">üìù</span>
                        <input type="text" id="title" name="title" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏">
                        <div class="input-focus-border"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏</label>
                    <div class="input-group">
                        <span class="input-icon">üìã</span>
                        <input type="text" id="description" name="description" placeholder="–î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏">
                        <div class="input-focus-border"></div>
                    </div>
                </div>

{{/*                <div class="form-group">*/}}
{{/*                    <label class="checkbox-label">*/}}
{{/*                        <input type="checkbox" id="isMultiUser" name="isMultiUser">*/}}
{{/*                        <span class="checkbox-custom"></span>*/}}
{{/*                        <span class="checkbox-text">–ù–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–∫–ª–∞–¥—á–∏–∫–æ–≤</span>*/}}
{{/*                    </label>*/}}
{{/*                </div>*/}}

{{/*                <div class="form-group" id="participantsGroup" style="display: none;">*/}}
{{/*                    <label for="maxParticipants">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –î–æ–∫–ª–∞–¥—á–∏–∫–æ</label>*/}}
{{/*                    <div class="input-group">*/}}
{{/*                        <span class="input-icon">üë•</span>*/}}
{{/*                        <input type="number" id="maxParticipants" name="maxParticipants" min="2" max="5" value="2">*/}}
{{/*                        <div class="input-focus-border"></div>*/}}
{{/*                    </div>*/}}
{{/*                </div>*/}}
                
                <button type="submit" id="createConferenceButton" class="conference-button">
                    <span>–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é</span>
                    <svg class="button-icon" viewBox="0 0 24 24">
                        <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
                    </svg>
                </button>
            </form>
        </div>
    </section>

    <section id="conferenceSection" class="conference d-none">
        <div class="conference-room">
            <div class="conference-header">
                <h2 id="conference-title">–í–∏–¥–µ–æ–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è</h2>
                <p id="conference-description"></p>
                <div class="conference-controls">
                    <button class="control-button" id="toggleVideo" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –≤–∏–¥–µ–æ">
                        <svg class="control-icon" viewBox="0 0 24 24">
                            <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                        </svg>
                    </button>
                    <button class="control-button" id="toggleAudio" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω">
                        <svg class="control-icon" viewBox="0 0 24 24">
                            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                            <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                        </svg>
                    </button>
                    <button class="control-button" id="toggleChat" title="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —á–∞—Ç">
                        <svg class="control-icon" viewBox="0 0 24 24">
                            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>
                        </svg>
                    </button>
                    <button class="control-button danger" id="endCallButton" title="–ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–≤–æ–Ω–æ–∫">
                        <svg class="control-icon" viewBox="0 0 24 24">
                            <path d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.11-.7-.28-.79-.73-1.68-1.36-2.66-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/>
                        </svg>
                    </button>
                    <button class="control-button" id="CopyButton" title="–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π">
                        <svg class="control-icon" viewBox="0 0 24 24">
                            <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="conference-content">
                <div class="video-section">
                    <div class="video-grid grid-mode">
                        <div id="remoteVideos" class="d-flex flex-wrap gap-3">
                        </div>
                    </div>
                </div>

                <div class="chat-section" id="chatSection">
                    <div class="chat-header">
                        <h3>–ß–∞—Ç</h3>
                        <button class="chat-toggle" id="chatToggle" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —á–∞—Ç">
                            <svg class="chat-icon" viewBox="0 0 24 24">
                                <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="chat-container">
                        <div id="chatMessages" class="chat-messages"></div>
                        
                        <div class="chat-input-container">
                            <div class="input-group">
                                <input type="text" id="chatInput" class="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                                <button id="sendMessage" class="send-button">
                                    <svg class="send-icon" viewBox="0 0 24 24">
                                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<style>
@media (max-width: 1024px) {
    .conference-content {
        flex-direction: column;
    }
    
    .video-section {
        width: 100%;
        height: 60vh;
    }
    
    .chat-section {
        width: 100%;
        height: 100%;
    }
}

@media (max-width: 768px) {
    .conference-header h2 {
        font-size: 1.5rem;
    }
    
    .conference-controls {
        gap: 0.5rem;
    }
    
    .control-button {
        width: 40px;
        height: 40px;
    }
    
    .video-section {
        height: 50vh;
    }
    
    .chat-section {
        height: 50vh;
    }
    
    .chat-section.collapsed {
        height: 50px;
    }
}

@media (max-width: 480px) {
    .conference-header h2 {
        font-size: 1.2rem;
    }
    
    .conference-controls {
        gap: 0.3rem;
    }
    
    .control-button {
        width: 36px;
        height: 36px;
    }
    
    .control-icon {
        width: 18px;
        height: 18px;
    }
    
    .video-section {
        height: 40vh;
    }
    
    .chat-section {
        height: 60vh;
    }
    
    .chat-section.collapsed {
        height: 40px;
    }
    
    .chat-header h3 {
        font-size: 1rem;
    }
    
    .chat-input {
        font-size: 0.9rem;
    }
}

@media (max-width: 768px) and (orientation: portrait) {
    .conference-content {
        flex-direction: column;
    }
    
    .video-section {
        height: 40vh;
    }
    
    .chat-section {
        height: 60vh;
    }
}

@media (max-width: 1024px) and (orientation: landscape) {
    .conference-content {
        flex-direction: row;
    }
    
    .video-section {
        width: 70%;
        height: 100%;
    }
    
    .chat-section {
        width: 30%;
        height: inherit;
    }
}

.checkbox-label {
    display: flex;
    align-items: center;
    cursor: pointer;
    margin: 10px 0;
}

.checkbox-custom {
    position: relative;
    display: inline-block;
    width: 20px;
    height: 20px;
    background: #fff;
    border: 2px solid #4a90e2;
    border-radius: 4px;
    margin-right: 10px;
    transition: all 0.3s;
}

.checkbox-custom::after {
    content: '';
    position: absolute;
    display: none;
    left: 6px;
    top: 2px;
    width: 5px;
    height: 10px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
}

input[type="checkbox"] {
    display: none;
}

input[type="checkbox"]:checked + .checkbox-custom {
    background: #4a90e2;
}

input[type="checkbox"]:checked + .checkbox-custom::after {
    display: block;
}

.checkbox-text {
    font-size: 1rem;
    color: #333;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ */
#participantsGroup {
    transition: all 0.3s ease;
}

#maxParticipants {
    width: 100%;
    padding: 10px;
    border: 2px solid #e0e0e0;
    border-radius: 4px;
    font-size: 1rem;
    transition: all 0.3s;
}

#maxParticipants:focus {
    border-color: #4a90e2;
    outline: none;
}

#maxParticipants::-webkit-inner-spin-button,
#maxParticipants::-webkit-outer-spin-button {
    opacity: 1;
    height: 30px;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —á–∞—Ç–∞
    const chatToggle = document.getElementById('chatToggle');
    const chatSection = document.getElementById('chatSection');
    
    if (chatToggle && chatSection) {
        chatToggle.addEventListener('click', function() {
            chatSection.classList.toggle('collapsed');
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —á–∞—Ç–∞ –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    const toggleChatBtn = document.getElementById('toggleChat');
    
    if (toggleChatBtn && chatSection) {
        toggleChatBtn.addEventListener('click', function() {
            chatSection.classList.toggle('collapsed');
        });
    }
    
    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    function adjustForMobile() {
        const isMobile = window.innerWidth <= 768;
        const chatSection = document.getElementById('chatSection');
        
        if (isMobile && chatSection) {
            // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —á–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–≤–µ—Ä–Ω—É—Ç
            chatSection.classList.add('collapsed');
        } else if (chatSection) {
            // –ù–∞ –¥–µ—Å–∫—Ç–æ–ø–∞—Ö —á–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç
            chatSection.classList.remove('collapsed');
        }
    }
    
    // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    adjustForMobile();
    window.addEventListener('resize', adjustForMobile);

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —á–µ–∫–±–æ–∫—Å–∞ —Ç–∏–ø–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    const isMultiUser = document.getElementById('isMultiUser');
    const participantsGroup = document.getElementById('participantsGroup');
    
    if (isMultiUser && participantsGroup) {
        isMultiUser.addEventListener('change', function() {
            participantsGroup.style.display = this.checked ? 'block' : 'none';
        });
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
    const form = document.getElementById('createConferenceForm');
    if (form) {
        form.addEventListener('submit', function(event) {
            if (isMultiUser.checked) {
                const maxParticipants = document.getElementById('maxParticipants').value;
                if (maxParticipants < 2 || maxParticipants > 5) {
                    alert('–î–ª—è –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 2 –¥–æ 5');
                    event.preventDefault();
                    return;
                }
            }
        });
    }
});
</script>
